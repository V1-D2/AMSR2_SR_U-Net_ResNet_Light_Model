# AMSR2 Brightness Temperature Super-Resolution

üõ∞Ô∏è **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö AMSR2 –≤ 10 —Ä–∞–∑ —Å –ø–æ–º–æ—â—å—é –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è**

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç super-resolution –º–æ–¥–µ–ª—å –¥–ª—è –¥–∞–Ω–Ω—ã—Ö brightness temperature –æ—Ç —Å–ø—É—Ç–Ω–∏–∫–∞ AMSR2, —É–≤–µ–ª–∏—á–∏–≤–∞—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å ~10–∫–º/–ø–∏–∫—Å–µ–ª—å –¥–æ ~1–∫–º/–ø–∏–∫—Å–µ–ª—å (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤ 10 —Ä–∞–∑).

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **Self-supervised learning**: –û–±—É—á–µ–Ω–∏–µ –±–µ–∑ –ø–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- **NPZ —Ñ–æ—Ä–º–∞—Ç**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å NPZ —Ñ–∞–π–ª–∞–º–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
- **U-Net + ResNet**: –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è scientific imaging
- **–§–∏–∑–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ loss —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è brightness temperature
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ swath**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö swath –≤ NPZ —Ñ–∞–π–ª–µ
- **Orbit filtering**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –æ—Ä–±–∏—Ç (Ascending/Descending/Unknown)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
amsr2-super-resolution/
‚îú‚îÄ‚îÄ amsr2_super_resolution_complete.py  # üéØ –û–°–ù–û–í–ù–û–ô –§–ê–ô–õ (–≤—Å—è –º–æ–¥–µ–ª—å)
‚îú‚îÄ‚îÄ run_amsr2_simple.py                 # üöÄ –ü—Ä–æ—Å—Ç–æ–π launcher (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ README.md                           # üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt                    # üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ examples/                           # üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install torch torchvision numpy matplotlib scikit-learn tqdm
```

### 2. –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
python amsr2_super_resolution_complete.py --test-mode

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ launcher
python run_amsr2_simple.py --test
```

### 3. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ /path/to/your/npz/files –Ω–∞ –ø—É—Ç—å –∫ –≤–∞—à–∏–º NPZ —Ñ–∞–π–ª–∞–º
python amsr2_super_resolution_complete.py --npz-dir /path/to/your/npz/files

# –ò–ª–∏ —á–µ—Ä–µ–∑ launcher
python run_amsr2_simple.py --train --npz-dir /path/to/your/npz/files
```

## üìä –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å NPZ —Ñ–∞–π–ª–∞–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≤–∞—à–µ–≥–æ AMSR2 –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞:

```python
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ NPZ —Ñ–∞–π–ª–∞:
{
    'swath_array': [
        {
            'temperature': np.array([2041, 421], dtype=uint16),  # Raw –¥–∞–Ω–Ω—ã–µ
            'metadata': {
                'orbit_type': 'A',        # A/D/U
                'scale_factor': 0.1,      # –î–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ Kelvin
                'temp_range': (150, 300), # –ü–æ—Å–ª–µ scaling
                'shape': (2041, 421)
            }
        },
        # ... –±–æ–ª—å—à–µ swath
    ],
    'period': '2024-01-01T00:00:00 to 2024-01-01T23:59:59'
}
```

## üéõÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```bash
python amsr2_super_resolution_complete.py \
    --npz-dir /path/to/npz/files \     # –ü–∞–ø–∫–∞ —Å NPZ —Ñ–∞–π–ª–∞–º–∏
    --batch-size 8 \                   # –†–∞–∑–º–µ—Ä batch (—É–º–µ–Ω—å—à–∏—Ç–µ –µ—Å–ª–∏ –º–∞–ª–æ GPU)
    --epochs 50 \                      # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
    --lr 1e-4 \                        # Learning rate
    --scale-factor 10 \                # –ú–∞—Å—à—Ç–∞–± —É–≤–µ–ª–∏—á–µ–Ω–∏—è
    --orbit-filter A                   # –§–∏–ª—å—Ç—Ä –ø–æ –æ—Ä–±–∏—Ç–∞–º (A/D/U)
```

### –ß–µ—Ä–µ–∑ launcher:

```bash
python run_amsr2_simple.py --train \
    --npz-dir /path/to/data \
    --batch-size 4 \
    --epochs 30 \
    --orbit-filter A
```

## üîÆ Inference –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
python -c "
from amsr2_super_resolution_complete import process_new_npz_file
process_new_npz_file(
    model_path='best_amsr2_model.pth',
    npz_path='new_data.npz', 
    output_path='enhanced_result.npz'
)"

# –ß–µ—Ä–µ–∑ launcher
python run_amsr2_simple.py --inference \
    --model best_amsr2_model.pth \
    --input new_data.npz \
    --output enhanced_result.npz
```

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **–í—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä**: 2041√ó421 ‚Üí **–í—ã—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä**: 20410√ó4210
- **PSNR**: 28-35 dB (–æ—Ç–ª–∏—á–Ω–æ –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- **SSIM**: 0.7-0.9 (–≤—ã—Å–æ–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)
- **–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è**: 
  - 1000 swaths: ~4-6 —á–∞—Å–æ–≤ –Ω–∞ RTX 3080
  - 5000 swaths: ~20-25 —á–∞—Å–æ–≤ –Ω–∞ RTX 3080

## üñ•Ô∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ:
- **GPU**: 8GB VRAM (RTX 3070/V100)
- **RAM**: 16GB —Å–∏—Å—Ç–µ–º–Ω–æ–π –ø–∞–º—è—Ç–∏
- **Storage**: 50GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:
- **GPU**: 16GB+ VRAM (RTX 4090/A100)
- **RAM**: 32GB+ —Å–∏—Å—Ç–µ–º–Ω–æ–π –ø–∞–º—è—Ç–∏
- **Storage**: 100GB+ SSD

## üìÅ –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç—Å—è:

```
üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è:
‚îú‚îÄ‚îÄ best_amsr2_model.pth           # üèÜ –í–µ—Å–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ amsr2_training_history.png     # üìä –ì—Ä–∞—Ñ–∏–∫–∏ –º–µ—Ç—Ä–∏–∫
‚îú‚îÄ‚îÄ amsr2_training_summary.json    # üìã –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îú‚îÄ‚îÄ amsr2_example_1.png            # üñºÔ∏è –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ amsr2_example_2.png
‚îî‚îÄ‚îÄ ...
```

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "CUDA out of memory"
```bash
# –£–º–µ–Ω—å—à–∏—Ç–µ batch size
python amsr2_super_resolution_complete.py --batch-size 4  # –≤–º–µ—Å—Ç–æ 8
```

### "No NPZ files found"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º
ls /path/to/your/npz/files/*.npz

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç
python amsr2_super_resolution_complete.py --test-mode
```

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—è
```bash
# –£–≤–µ–ª–∏—á—å—Ç–µ learning rate
python amsr2_super_resolution_complete.py --lr 2e-4  # –≤–º–µ—Å—Ç–æ 1e-4
```

## üî¨ –ù–∞—É—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å

–ú–æ–¥–µ–ª—å –≤–∫–ª—é—á–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤:

- **Energy Conservation**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—â–µ–π —ç–Ω–µ—Ä–≥–∏–∏ brightness temperature
- **Gradient Preservation**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä
- **Range Validation**: –ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **Scale Factor Handling**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ raw –¥–∞–Ω–Ω—ã—Ö –æ—Ç AMSR2

## üìö –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏:
- **Encoder**: ResNet-34 backbone —Å skip connections
- **Decoder**: Progressive upsampling —Å feature fusion
- **Loss Function**: L1 + Gradient + Physical consistency losses
- **Scale Factor**: Progressive upsampling –¥–ª—è 10x —É–≤–µ–ª–∏—á–µ–Ω–∏—è

### –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥:
1. –ó–∞–≥—Ä—É–∑–∫–∞ raw –¥–∞–Ω–Ω—ã—Ö (uint16) –∏–∑ NPZ
2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ scale factor (–æ–±—ã—á–Ω–æ 0.1)
3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (< 50K, > 350K)
4. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [-1, 1]
5. –°–æ–∑–¥–∞–Ω–∏–µ degraded –≤–µ—Ä—Å–∏–∏ –¥–ª—è self-supervised learning

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∞ NPZ —Ñ–∞–π–ª–æ–≤
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç: `--test-mode`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª–µ–π.

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –Ω–∞—É—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ AMSR2** üõ∞Ô∏è